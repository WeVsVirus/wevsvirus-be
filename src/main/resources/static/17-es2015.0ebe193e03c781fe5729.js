(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{TUkU:function(t,e,o){"use strict";o.r(e);var i=o("TEn/"),n=o("tyNb"),r=o("ofXK"),a=o("3Pt+"),s=o("mrSG"),c=o("gcOT"),l=o("fXoL");const{Camera:h,Filesystem:d,Storage:b}=c.e;let u=(()=>{class t{constructor(t){this.photos=[],this.PHOTO_STORAGE="photos",this.convertBlobToBase64=t=>new Promise((e,o)=>{const i=new FileReader;i.onerror=o,i.onload=()=>{e(i.result)},i.readAsDataURL(t)}),this.platform=t}loadSaved(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield b.get({key:this.PHOTO_STORAGE});if(this.photos=JSON.parse(t.value)||[],!this.platform.is("hybrid"))for(let e of this.photos){const t=yield d.readFile({path:e.filepath,directory:c.d.Data});e.base64=`data:image/jpeg;base64,${t.data}`}}))}addNewToGallery(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield h.getPhoto({resultType:c.a.Uri,source:c.b.Camera,quality:100}),e=yield this.savePicture(t);this.photos.unshift(e),b.set({key:this.PHOTO_STORAGE,value:this.platform.is("hybrid")?JSON.stringify(this.photos):JSON.stringify(this.photos.map(t=>{const e=Object.assign({},t);return delete e.base64,e}))})}))}savePicture(t){return Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.readAsBase64(t),o=(new Date).getTime()+".jpeg";return yield d.writeFile({path:o,data:e,directory:c.d.Data}),yield this.getPhotoFile(t,o)}))}readAsBase64(t){return Object(s.a)(this,void 0,void 0,(function*(){if(this.platform.is("hybrid"))return(yield d.readFile({path:t.path})).data;{const e=yield fetch(t.webPath),o=yield e.blob();return yield this.convertBlobToBase64(o)}}))}getPhotoFile(t,e){return Object(s.a)(this,void 0,void 0,(function*(){if(this.platform.is("hybrid")){const t=yield d.getUri({directory:c.d.Data,path:e});return{filepath:t.uri,webviewPath:c.c.convertFileSrc(t.uri)}}return{filepath:e,webviewPath:t.webPath}}))}deletePicture(t,e){return Object(s.a)(this,void 0,void 0,(function*(){this.photos.splice(e,1),b.set({key:this.PHOTO_STORAGE,value:JSON.stringify(this.photos)});const o=t.filepath.substr(t.filepath.lastIndexOf("/")+1);yield d.deleteFile({path:o,directory:c.d.Data})}))}}return t.\u0275fac=function(e){return new(e||t)(l.Sb(i.J))},t.\u0275prov=l.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function p(t,e){if(1&t){const t=l.Pb();l.Ob(0,"ion-col",6),l.Ob(1,"ion-img",7),l.Wb("click",(function(o){l.fc(t);const i=e.$implicit,n=e.index;return l.Yb().showActionSheet(i,n)})),l.Nb(),l.Nb()}if(2&t){const t=e.$implicit;l.zb(1),l.cc("src",t.base64?t.base64:t.webviewPath)}}let f=(()=>{class t{constructor(t,e){this.photoService=t,this.actionSheetController=e}ngOnInit(){this.photoService.loadSaved()}showActionSheet(t,e){return Object(s.a)(this,void 0,void 0,(function*(){const o=yield this.actionSheetController.create({header:"Photos",buttons:[{text:"Delete",role:"destructive",icon:"trash",handler:()=>{this.photoService.deletePicture(t,e)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{}}]});yield o.present()}))}}return t.\u0275fac=function(e){return new(e||t)(l.Jb(u),l.Jb(i.a))},t.\u0275cmp=l.Db({type:t,selectors:[["app-tab2"]],decls:15,vars:1,consts:[["collapse","condense"],["size","large"],["size","6",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],[3,"click"],["name","camera"],["size","6"],[3,"src","click"]],template:function(t,e){1&t&&(l.Ob(0,"ion-header"),l.Ob(1,"ion-toolbar"),l.Ob(2,"ion-title"),l.jc(3," Photo Gallery "),l.Nb(),l.Nb(),l.Nb(),l.Ob(4,"ion-content"),l.Ob(5,"ion-header",0),l.Ob(6,"ion-toolbar"),l.Ob(7,"ion-title",1),l.jc(8,"Photo Gallery"),l.Nb(),l.Nb(),l.Nb(),l.Ob(9,"ion-grid"),l.Ob(10,"ion-row"),l.ic(11,p,2,1,"ion-col",2),l.Nb(),l.Nb(),l.Ob(12,"ion-fab",3),l.Ob(13,"ion-fab-button",4),l.Wb("click",(function(t){return e.photoService.addNewToGallery()})),l.Kb(14,"ion-icon",5),l.Nb(),l.Nb(),l.Nb()),2&t&&(l.zb(11),l.bc("ngForOf",e.photoService.photos))},directives:[i.k,i.F,i.D,i.g,i.j,i.v,r.h,i.h,i.i,i.l,i.f,i.m],styles:["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:translucent}"]}),t})();var O=o("qtYk");o.d(e,"Tab2PageModule",(function(){return y}));let y=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(e){return new(e||t)},imports:[[i.G,r.b,a.a,O.a,n.i.forChild([{path:"",component:f}])]]}),t})()}}]);